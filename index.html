<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Facebook-datasource-for-cakephp : A DataSource for CakePHP 2.x based on Facebook API" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Facebook Plugin for CakePHP</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" target="_blank" href="https://github.com/marianofino/Facebook-Plugin-for-CakePHP">View on GitHub</a>

          <h1 id="project_title">Facebook Plugin for CakePHP</h1>
          <h2 id="project_tagline">DataSource and oAuth for CakePHP 2.x based on Facebook API</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/marianofino/Facebook-Plugin-for-CakePHP/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/marianofino/Facebook-Plugin-for-CakePHP/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3>Installation</h3>
        <div class="step">
        	<strong>Step 1. </strong>Download, unzip and rename the folder to <strong>Facebook</strong> and move it to the Plugin's folder of your CakePHP project.</li>

        	
        </div>
        <div class="step"><strong>Step 2.</strong> In Config/bootstrap.php, enable the plugin and it's bootstrap, by adding a line like this:
        		<pre>CakePlugin::loadAll(
	array('Facebook' => array('bootstrap' => true))
);</pre>
        </div>
        <div class="step">
        	<strong>Step 3.</strong> You <strong>must</strong> have a table for Users, with at least one field for "username". Something like this is fine:
				<pre>CREATE TABLE users (
    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50)
);</pre>
        </div>
        <div class="step">
        	<strong>Step 4.</strong> Enable Auth component in AppController.php and link it to Facebook Authentication. For example:
        		<pre>public $components = array(
	'Session',
	'Auth' => array(
		'loginRedirect' => array('controller' => 'users', 'action' => 'view'),
		'logoutRedirect' => '/',
		'authenticate' => array(
			'all' => array('userModel' => 'User'),
			'Facebook.Oauth'
		)
	)
);</pre>
        </div>
		<div class="step">
			<strong>Step 5.</strong> In Config/database.php, enter the AppKey and AppSecret from your Facebook App, your app complete url, and your login action:
<pre>public $facebook = array(
	'datasource' => 'Facebook.FQL',
	'app_url' => 'http://www.yourdomain.com/path/to/cake', // or just http://www.yourdomain.com if it's on the root
	'app_id' => '35868871xxxxxx',
	'app_secret' => '6059c46e362346xxxxxxxxxxxx',
	'login_url' => array('controller' => 'users', 'action' => 'login') // probably right
);</pre>
		</div>

<p>You're ready!! Now proceed with the <a href="#tutorial">tutorial</a>.</p>

<h3 id="tutorial">Usage</h3>

<p>This is a tiny tutorial to learn the basis:</p>

		<div class="step">
			<strong>Step 1.</strong> Create a controller with some default actions for login() and logout(). Also we will add some method to test the API. Create UsersController.php like this:
<pre><&#63;php
App::uses('AppController', 'Controller');
class UsersController extends AppController {
	public $uses = array('Facebook.FacebookUser');
	public $helpers = array('Facebook.Facebook','Session','Html');

	public function login() {
		if ($this->Auth->login()) {
			$this->redirect($this->Auth->redirect());
		}
	}

	public function logout() {
		$this->redirect($this->Auth->logout());
	}
	
	public function view() {
		$userInfo = $this->FacebookUser->find('all', array('conditions' => array('username' => $this->Auth->User('id')), 'fields' => array('first_name','last_name')));
		$this->set(compact('userInfo'));
	}
}
&#63;>
</pre>
</div>
		<div class="step">
			<strong>Step 2.</strong> Create a simple model, like this:
<pre><&#63;php
App::uses('AppModel', 'Model');

class User extends AppModel {
}
&#63;></pre>
		</div>
		<div class="step">
			<strong>Step 3.</strong> Create 2 views. One in Users/login.ctp and the other in Users/view.ctp:
			<p>login.ctp
			<pre><&#63;php
	echo $this->Facebook->loginButton('Login');
&#63;></pre></p>
			<p>view.ctp
			<pre><&#63;php
	echo "Hello ".$userInfo['FacebookUser']['first_name']." ".$userInfo['FacebookUser']['last_name']."<br />";
	echo $this->Html->link('Logout', array('controller' => 'users', 'action' => 'logout'));
&#63;></pre></p>
		</div>
		
		<p>Congratulations! Now go to www.yourdomain.com/path/to/cake/ and test that everything works as expected!</p>

<strong>Appendix</strong>

<p>For now, you can only read information, by using the method <strong>find('all', $options)</strong>. For more information you can look at the <a href="https://developers.facebook.com/docs/reference/fql/">FQL reference</a>. Another limitation, is that only supports "user" table by now.</p>

<p>For example, to read information from the FQL table "user", you can do in any controller:
	<pre>$uses = array('Facebook.FacebookUser');
public function viewUser() {
	$options = array(
		array(
			'fields' => array('username','first_name','last_name'),
			'conditions' => ('id' => '1390757189')
		)
	);
	$userInfo = $this->FacebookUser->find('all', $options);
}</pre></p>

<h3>How to Contribute</h3>

<p>If you want to contribute please get in touch through the <a href="#comments">support section</a>, by <a href="http://twitter.com/finomdq" target="_blank">twitter</a> or <a href="https://github.com/marianofino/Facebook-Plugin-for-CakePHP" target="_blank">github</a>. Also, you can fix or submit new issues on <a href="https://github.com/marianofino/Facebook-Plugin-for-CakePHP/issues" target="_blank">github</a>.</p>

<h3>Authors and Contributors</h3>

<p>Copyright (c) 2012 - Mariano Finochietto // twitter: @finomdq // github: @marianofino.</p> <!-- <a href="https://github.com/mojombo" class="user-mention">@mojombo</a> -->
<p>The Auth component is based on the danielauener's "FacebookAuthenticate". You can find more information here: <a href="https://github.com/danielauener/cake-social-custom-auth" target="_blank">https://github.com/danielauener/cake-social-custom-auth</a></p>

<h3>License</h3>

<p>This software is released under the <a href="http://www.gnu.org/licenses/lgpl-3.0.txt" target="_blank">GNU LGPL License</a>.</p>

<h3 id="comments">Comments &amp; Support</h3>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'facebookpluginforcakephp'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink" target="_blank">comments powered by <span class="logo-disqus">Disqus</span></a>
 
      </section>
    </div>
    

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Facebook Plugin for CakePHP maintained by <a href="https://github.com/marianofino" target="_blank">marianofino</a></p>
        <p>Published with <a href="http://pages.github.com" target="_blank">GitHub Pages</a></p>
      </footer>
    </div>



  </body>
</html>
